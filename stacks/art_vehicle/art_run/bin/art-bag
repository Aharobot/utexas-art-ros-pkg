#!/bin/bash
# $Id$

if [ "$2" == "" ]
then
	echo "usage: `basename $0` [get|put] subtree"
        echo ""
        echo "copy bag files to or from www.landrobot.com"
	exit 9
fi

CMD=$1
SUBTREE=$2
SITE=www.landrobot.com
BAGS=${ROS_HOME:-~/.ros}/bags

if [ $CMD == "put" ]
then
        FROM=$BAGS/$SUBTREE
        TO=$SITE:/pub/bags
        cd $FROM
        echo "compressing all .bag files"
        gzip *.bag 2>/dev/null

elif [ $CMD == "get" ]
then
        FROM=$SITE:/pub/bags/$SUBTREE
        TO=$BAGS
        mkdir -p $BAGS    # make sure target exists
else
        echo "invalid command:" $CMD
        exit 8
fi

echo rsync -Phavr $FROM $TO
exec rsync -Phavr $FROM $TO

