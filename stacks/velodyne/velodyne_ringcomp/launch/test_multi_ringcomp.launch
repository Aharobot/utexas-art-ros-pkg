<!-- -*- mode: XML -*- -->
<!-- look for obstacles in a Velodyne PCAP file

     This test version launches multiple copies of the ringcomp
     nodelet in a single process.

     environment: $PCAP = full path name of PCAP file.
-->

<launch>

  <node pkg="nodelet" type="nodelet" name="velodyne_nodelet_manager"
        args="manager" />
  <node pkg="nodelet" type="nodelet" name="transform_nodelet"
        args="load velodyne_common/TransformNodelet velodyne_nodelet_manager" />
  <node pkg="nodelet" type="nodelet" name="driver_nodelet"
        args="load velodyne_common/DriverNodelet velodyne_nodelet_manager" >
    <param name="pcap" value="$(env PCAP)" />
  </node>

  <node pkg="nodelet" type="nodelet" name="ringcomp_nodelet"
        args="load velodyne_ringcomp/RingCompNodelet velodyne_nodelet_manager" />

  <node pkg="nodelet" type="nodelet" name="ringcomp_nodelet2"
        args="load velodyne_ringcomp/RingCompNodelet velodyne_nodelet_manager" >
    <remap from="velodyne/obstacles" to="velodyne/obstacles2" /> 
  </node>

  <node pkg="nodelet" type="nodelet" name="ringcomp_nodelet3"
        args="load velodyne_ringcomp/RingCompNodelet velodyne_nodelet_manager" >
    <remap from="velodyne/obstacles" to="velodyne/obstacles3" /> 
  </node>

  <node pkg="nodelet" type="nodelet" name="ringcomp_nodelet4"
        args="load velodyne_ringcomp/RingCompNodelet velodyne_nodelet_manager" >
    <remap from="velodyne/obstacles" to="velodyne/obstacles4" /> 
  </node>

  <node pkg="nodelet" type="nodelet" name="ringcomp_nodelet5"
        args="load velodyne_ringcomp/RingCompNodelet velodyne_nodelet_manager" >
    <remap from="velodyne/obstacles" to="velodyne/obstacles5" /> 
  </node>

  <node pkg="nodelet" type="nodelet" name="ringcomp_nodelet6"
        args="load velodyne_ringcomp/RingCompNodelet velodyne_nodelet_manager" >
    <remap from="velodyne/obstacles" to="velodyne/obstacles6" /> 
  </node>

  <!-- publish  /vehicle -> /velodyne transform -->
  <node pkg="tf" type="static_transform_publisher" name="vehicle_velodyne_tf"
        args="0.393 0.278 2.4 -0.02155 0.0164 0.00621 /vehicle /velodyne 1000" />
  <!-- publish identity /odom -> /vehicle transform for viewing static sensor data -->
  <node pkg="tf" type="static_transform_publisher" name="vehicle_is_odom"
        args="0 0 0 0 0 0 /odom /vehicle 1000" />

</launch>
